webpackJsonp([13],{FOyr:function(e,t){},N1If:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xxa5"),r=n.n(a),o=n("exGp"),i=n.n(o),s=n("bOdI"),c=n.n(s),u=(n("NC6I"),n("mtWM"),{data:function(){return c()({mobile:"",code:"",res:"",time:60,isShow:!0,timer:null},"code","")},updated:function(){},mounted:function(){},created:function(){var e=this;return i()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.getUrlParam("code"))){t.next=10;break}return t.next=4,e.getOpenid(n);case 4:return a=t.sent,t.next=7,e.wLongin(a);case 7:t.sent,t.next=11;break;case 10:e.wechateLogin();case 11:case"end":return t.stop()}},t,e)}))()},methods:{getContent:function(){var e=iframe.contentWindow.document.getElementById("iToolCode");if(e){var t=e.innerHTML;t=t.replace(/<span.+?>/g,"").replace(/<\/span>/g,""),alert(t),t=JSON.parse(t),this.res=t,alert(t.data.open_id)}else setTimeout(this.getContent,200)},login:function(){var e=this;return i()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(/^\d{11}$/.test(e.mobile)){t.next=3;break}return e.$dialog.alert({message:"请输入正确的手机号"}).then(function(){}),t.abrupt("return",!1);case 3:return t.next=5,e.$http.post("auth/verification_code/login",{mobile:e.mobile,code:e.code});case 5:if(200!=(n=t.sent).code){t.next=15;break}return localStorage.setItem("token",n.data.token),t.next=10,e.$http.get("auth/info");case 10:200==(a=t.sent).code&&(localStorage.setItem("nickname",a.data.nickname||"手机用户"+a.data.mobile.substr(-4)),localStorage.setItem("gender",a.data.gender),localStorage.setItem("avatar",a.data.avatar),localStorage.setItem("level",a.data.level)),e.$router.push("/"),t.next=15;break;case 15:case"end":return t.stop()}},t,e)}))()},getValidCode:function(){var e=this;return i()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(/^\d{11}$/.test(e.mobile)){t.next=3;break}return e.$dialog.alert({message:"请输入正确的手机号"}).then(function(){}),t.abrupt("return",!1);case 3:return t.next=5,e.$http.get("sms/send/"+e.mobile+"/4");case 5:200==t.sent.code&&(e.isShow=!1,e.timer=setInterval(function(){e.$nextTick(function(){e.time--}),e.time<=0&&(e.isShow=!0,clearInterval(e.timer),e.timer=null,e.time=60)},1e3));case 7:case"end":return t.stop()}},t,e)}))()}}}),l={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"page-login"})},staticRenderFns:[]};var d=n("VU/8")(u,l,!1,function(e){n("FOyr")},"data-v-04ab6b0e",null);t.default=d.exports}});
//# sourceMappingURL=13.c496738ad061b40d7a00.js.map